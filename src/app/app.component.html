<div class="container">
  <header class="hero">
    <div class="hero-text">
      <h1>{{ TITLE }}</h1>
      <p class="subtitle">سامانه ساده و زیبا برای مدیریت سمت‌ها و پست‌ها</p>
      <div class="cta">
        <button class="btn-main" (click)="openModal()">📋 مدیریت سمت‌ها</button>
      </div>
    </div>
    <div class="hero-stats">
      <div class="stat">
        <div class="stat-value">{{ mainGridData.length }}</div>
        <div class="stat-label">رکورد ثبت‌شده</div>
      </div>
      <div class="stat">
        <div class="stat-value">{{ jobTitles.length }}</div>
        <div class="stat-label">عنوان سطح</div>
      </div>
      <div class="stat">
        <div class="stat-value">✔︎</div>
        <div class="stat-label">ویرایش و افزودن سریع</div>
      </div>
    </div>
  </header>

  <div class="modal" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">

      <div class="modal-header">
        <h2>مدیریت سمت‌ها</h2>
        <button class="close-btn" (click)="closeModal()">×</button>
      </div>

      <div class="table-wrapper" role="region" aria-label="جدول سمت‌ها">
        <table>
          <thead>
            <tr>
              <th>سطح</th>
              <th>عنوان سطح</th>
              <th>شماره پست</th>
              <th>سمت پیش‌فرض</th>
              <th>سمت کاربر</th>
              <th>عملیات</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of mainGridData; let i = index">
              <td>{{ item.level }}</td>
              <td>{{ item.title }}</td>
              <td>{{ item.postNumber }}</td>
              <td>{{ item.defaultJobTitle }}</td>
              <td>{{ item.userJobTitle }}</td>
              <td class="action-buttons">
                <button class="btn-edit" (click)="editItem(i)" aria-label="ویرایش ردیف {{ i + 1 }}">✏️ ویرایش</button>
                <button class="btn-delete" (click)="deleteItem(i)" aria-label="حذف ردیف {{ i + 1 }}">🗑️ حذف</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="form-box" *ngIf="editingIndex !== null || adding">
        <h3>{{ editingIndex !== null ? 'ویرایش سمت' : 'افزودن سمت جدید' }}</h3>
        <form [formGroup]="form" (ngSubmit)="saveForm()">
          <input type="number" formControlName="level" placeholder="سطح" readonly />
          <select formControlName="title" (change)="onTitleSelected($event)">
            <option value="" disabled>انتخاب عنوان سطح</option>
            <option *ngFor="let job of jobTitles" [value]="job.title">{{ job.title }}</option>
          </select>
          <input type="number" formControlName="postNumber" placeholder="شماره پست" required />
          <input type="text" formControlName="defaultJobTitle" placeholder="سمت پیش‌فرض" />
          <input type="text" formControlName="userJobTitle" placeholder="سمت کاربر" />

          <div class="modal-footer">
            <button type="submit" class="btn-save" [disabled]="form.invalid">✔ ذخیره</button>
            <button type="button" class="btn-cancel" (click)="cancelForm()">❌ انصراف</button>
          </div>
        </form>
      </div>

      <div class="modal-footer" *ngIf="editingIndex === null && !adding">
        <button class="btn-add" (click)="addItem()">➕ افزودن</button>
      </div>

    </div>
  </div>
</div>
