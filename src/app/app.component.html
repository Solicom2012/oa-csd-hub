<div class="container">
  <h1>{{ TITLE }}</h1>
  <button class="btn-main" (click)="openModal()">📋 ,rdxcvnbمدیریت سمت‌ها</button>

  <div class="modal" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">

      <div class="modal-header">
        <h2>مدیریت سمت‌ها</h2>
        <button class="close-btn" (click)="closeModal()">×</button>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>سطح</th>
              <th>عنوان سطح</th>
              <th>شماره پست</th>
              <th>سمت پیش‌فرض</th>
              <th>سمت کاربر</th>
              <th>عملیات</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of mainGridData; let i = index">
              <td>{{ item.level }}</td>
              <td>{{ item.title }}</td>
              <td>{{ item.postNumber }}</td>
              <td>{{ item.defaultJobTitle }}</td>
              <td>{{ item.userJobTitle }}</td>
              <td class="action-buttons">
                <button class="btn-edit" (click)="editItem(i)">✏️ ویرایش</button>
                <button class="btn-delete" (click)="deleteItem(i)">🗑️ حذف</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="form-box" *ngIf="editingIndex !== null || adding">
        <h3>{{ editingIndex !== null ? 'ویرایش سمت' : 'افزودن سمت جدید' }}</h3>
        <form [formGroup]="form" (ngSubmit)="saveForm()">
          <input type="number" formControlName="level" placeholder="سطح" readonly />
          <select formControlName="title" (change)="onTitleSelected($event)">
            <option value="" disabled>انتخاب عنوان سطح</option>
            <option *ngFor="let job of jobTitles" [value]="job.title">{{ job.title }}</option>
          </select>
          <input type="number" formControlName="postNumber" placeholder="شماره پست" required />
          <input type="text" formControlName="defaultJobTitle" placeholder="سمت پیش‌فرض" />
          <input type="text" formControlName="userJobTitle" placeholder="سمت کاربر" />

          <div class="modal-footer">
            <button type="submit" class="btn-save" [disabled]="form.invalid">✔ ذخیره</button>
            <button type="button" class="btn-cancel" (click)="cancelForm()">❌ انصراف</button>
          </div>
        </form>
      </div>

      <div class="modal-footer" *ngIf="editingIndex === null && !adding">
        <button class="btn-add" (click)="addItem()">➕ افزودن</button>
      </div>

    </div>
  </div>
</div>
